<%- include('../layouts/Header'); -%>
<%- include('../layouts/CSS'); -%>
<%- include('../layouts/endHeader'); -%>

<div id="wrapper">
  <%- include('../layouts/Sidebar'); -%>


  <!-- Content Wrapper -->
  <div id="content-wrapper" class="d-flex flex-column">

    <!-- Main Content -->
    <div id="content">

      <!-- Topbar -->
      <%- include('../layouts/topbarEIEI'); -%>
       <!-- End of Topbar -->

      <!-- Begin Page Content -->
      <div class="container-fluid">

        <div class="col-sm-10">
            <div class="container">

                <ul class="nav nav-tabs">
                    <li class="nav-item"><a class="nav-link active">จัดการห้อง</a></li>
                </ul>

                <table class="table table-striped" style="text-align: center">
                    <thead>
                        <tr>
                            <td><b>ชื่อห้อง</b></td>
                            <td><b>ชั้น</b></td>
                            <td><b>จำนวนที่นั่งทั้งหมด</b></td>
                            <td><b>จำนวนที่นั่งว่าง</b></td>
                            <td><b>เคลียร์ห้อง</b></td>
                            <td><b>ลบ</b></td>
                        </tr>
                    </thead>
                    <tbody>
                        <% for(var i=0; i < building.room.length ; i++) { %>
                        <tr>
                            <td>
                                <%= building.room[i].name %>
                            </td>
                            <td>
                                <%= building.room[i].floor %>
                            </td>
                            <td><%= building.room[i].seat.length %></td>

                            <% var emptySeat = 0 
                            for (let j = 0 ;  j < building.room[i].seat.length ; j++ ) {
                                if(building.room[i].seat[j].student == null) {
                                    emptySeat++
                                }
                            } %>

                            <td> <%= emptySeat %></td>
                            <td><a href="/manageBuilding/inRoom/<%= building.room[i]._id %>"
                                    class="btn btn-primary">ตรวจสอบ</a></td>
                            <td><a href="/manageBuilding/deleteRoom/<%= building.room[i]._id %>/<%=building._id%>"
                                    class="btn btn-danger">Delete</a></td>
                        </tr>
                        <% } %>

                    </tbody>
                </table>
                <a href="#" class="btn btn-success" data-toggle="modal" data-toggle="modal"
                    data-target=".AddRoom">เพิ่ม</a>


            </div>
        </div>


      </div>
      <!-- /.container-fluid -->

    </div>
    <!-- End of Main Content -->

  </div>
  <!-- End of Content Wrapper -->

</div>

<%- include('../modals/roomModal'); -%>
<%- include('../layouts/Bottom'); -%>